#!/usr/bin/env bash

# Install script for clapp
install() {
  if [[ -e "$HOME/repos/clapp" ]]; then
		local repo="$HOME/repos/clapp"
	else
		local repo="$(find "$HOME" -type d -name clapp 2>/dev/null)"
	fi
  cp -f "$repo"/clapp "$HOME"/bin/clapp || return 1
  [[ ! -e "$HOME/.clapp" ]] && mkdir "$HOME/.clapp"
  cp -f "$repo"/.clapp/.lib "$HOME"/.clapp/.lib || return 1
  cp -f "$repo"/.clapp/postbash4.lib "$HOME"/.clapp/postbash4.lib || return 1
  cp -f "$repo"/.clapp/prebash4.lib "$HOME"/.clapp/prebash4.lib || return 1
  [[ ! -e "$HOME/.clapp/.cfg" ]] && { cp -f "$repo"/.clapp/.cfg "$HOME"/.clapp/.cfg || return 1; }
  cp -f "$repo"/.clapp/help "$HOME"/.clapp/help || return 1
  cp -f "$repo"/.clapp/version "$HOME"/.clapp/version || return 1
  cp -f -r "$repo"/.clapp/assets "$HOME"/.clapp/ || return 1
  cp -f -r "$repo"/.clapp/docs "$HOME"/.clapp/ || return 1
  # Attempt to add completion to system, otherwise default to ~/.d/
  cp -f "$repo/.clapp/clapp-comp" "$HOME/.d/clapp-comp"
  echo "CLApp installed!"
}

install "$@"